{{include reference="PhenoTips.PatientSheetMacros" /}}

{{include reference="PhenoTips.FormMacros" /}}

{{velocity}}
$xwiki.jsx.use('PhenoTips.FamilyRecordField_status')
$xwiki.ssx.use('PhenoTips.FamilyRecordField_status')
#set ($familyMetaObj = $doc.getObject('PhenoTips.FamilyMetaClass'))
#set ($familyMetaClass = $familyMetaObj.xWikiClass)
#if ($xcontext.action == 'edit' || $doc.display('users') != [])
  (% class="fieldset analysis_status" %)(((
    #if ($xcontext.action == 'edit')
      {{html clean="false" wiki="false"}}<div class="currentUserName" style="display: none">$xwiki.getUserName($context.getUser())</div>{{/html}}##
      {{html clean="false" wiki="false"}}<input class="currentUser" type="hidden" value="${context.getUser()}">{{/html}}##
      $doc.display('analysis_status', $xcontext.action, $familyMetaObj) $familyMetaObj.xWikiClass.get('analysis_status').getTranslatedPrettyName()
    #else
      {{html clean="false" wiki="false"}}<label class="section">$familyMetaObj.xWikiClass.get('analysis_status').getTranslatedPrettyName() 
  </label>{{/html}}$doc.display('analysis_status', $xcontext.action, $familyMetaObj)
    #end
  )))
  (% class="fieldset users" %)(((
    #set ($for = "for='$!{familyMetaClass.name}_$!{familyMetaObj.number}_users'")
    #if ($xcontext.action == 'edit')
      {{html clean="false" wiki="false"}}<label class="section" $!{for}>$familyMetaObj.xWikiClass.get('users').getTranslatedPrettyName()
  </label>{{/html}}$doc.display('users', $xcontext.action, $familyMetaObj)
    #else
      {{html clean="false" wiki="false"}}<label class="section" $!{for}>$familyMetaObj.xWikiClass.get('users').getTranslatedPrettyName()
  </label>{{/html}}$doc.display('users', $xcontext.action, $familyMetaObj)
    #end
  )))
#end
{{/velocity}}